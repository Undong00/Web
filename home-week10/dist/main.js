(()=>{const e=document.getElementById("currency-selector"),t=document.getElementById("crypto-selector"),n=document.getElementById("exchange-rate"),c=document.getElementById("crypto-price"),o=document.getElementById("amount"),r=document.getElementById("from-currency"),a=document.getElementById("to-currency"),s=document.getElementById("conversion-result");async function i(e){try{const t=await fetch("https://api.exchangerate-api.com/v4/latest/USD"),c=await t.json(),o=c.rates.KRW,r=c.rates[e];l(n,o/r)}catch(e){n.textContent="환율 로드 실패",console.error("Error fetching exchange rate:",e)}}async function d(e){try{const t=await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${e}&vs_currencies=krw`),n=await t.json();if(!n[e]||void 0===n[e].krw)throw new Error("암호화폐 데이터를 가져올 수 없습니다.");{const t=n[e].krw;l(c,t)}}catch(e){c.textContent="암호화폐 가격 로드 실패",console.error("Error fetching cryptocurrency price:",e)}}function l(e,t){const n=parseFloat(e.textContent.replace(/[^\d.-]/g,""))||0;e.textContent=t?`${t.toFixed(2)} 원`:"N/A",e.classList.remove("up","down"),t>n?e.classList.add("up"):t<n&&e.classList.add("down")}e.addEventListener("change",(()=>i(e.value))),t.addEventListener("change",(()=>d(t.value))),document.getElementById("convert-button").addEventListener("click",(async function(){const e=parseFloat(o.value),t=r.value,n=a.value;if(isNaN(e)||e<=0)s.textContent="유효한 금액을 입력하세요.";else try{const c=await fetch(`https://api.exchangerate-api.com/v4/latest/${t}`),o=e*(await c.json()).rates[n];s.textContent=`${e} ${t} = ${o.toFixed(2)} ${n}`}catch(e){s.textContent="환율 계산 실패",console.error("Error converting currency:",e)}})),i(e.value),d(t.value)})();